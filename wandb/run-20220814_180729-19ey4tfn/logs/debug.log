2022-08-14 18:07:29,608 INFO    MainThread:30126 [wandb_setup.py:_flush():76] Configure stats pid to 30126
2022-08-14 18:07:29,608 INFO    MainThread:30126 [wandb_setup.py:_flush():76] Loading settings from /home/azureuser/.config/wandb/settings
2022-08-14 18:07:29,608 INFO    MainThread:30126 [wandb_setup.py:_flush():76] Loading settings from /home/azureuser/imagen/spaceforge/wandb/settings
2022-08-14 18:07:29,608 INFO    MainThread:30126 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'_require_service': 'True'}
2022-08-14 18:07:29,608 INFO    MainThread:30126 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'train.py', 'program': '/home/azureuser/imagen/spaceforge/train.py'}
2022-08-14 18:07:29,608 INFO    MainThread:30126 [wandb_init.py:_log_setup():461] Logging user logs to /home/azureuser/imagen/spaceforge/wandb/run-20220814_180729-19ey4tfn/logs/debug.log
2022-08-14 18:07:29,609 INFO    MainThread:30126 [wandb_init.py:_log_setup():462] Logging internal logs to /home/azureuser/imagen/spaceforge/wandb/run-20220814_180729-19ey4tfn/logs/debug-internal.log
2022-08-14 18:07:29,609 INFO    MainThread:30126 [wandb_init.py:init():495] calling init triggers
2022-08-14 18:07:29,609 INFO    MainThread:30126 [wandb_init.py:init():498] wandb.init called with sweep_config: {}
config: {'dataset.dataset_name': 'cc12m', 'dataset.dataset_path': '/datadrive4T/cc12m_w_embeds/{00000..01242}.tar', 'dataset.image_size': 256, 'dataset.shuffle_size': 1500, 'dataset.num_images': 10428650, 'dataset.num_workers': 24, 'dataset.prefetch_factor': 1, 'dataset.pin_memory': True, 'dataset.drop_last': True, 'dataset.precomputed_embeddings': True, 'train.epochs': 5, 'train.batch_size': 256, 'train.unet_number': 1, 'train.unet1_max_batch_size': 4, 'train.unet2_max_batch_size': 2, 'train.load_checkpoint': False, 'train.load_checkpoint_path': '/datadrive4T/checkpoint/imagen_large_checkpoint.pt', 'train.checkpoint_rate': 1000, 'train.checkpoint_path': '/datadrive4T/checkpoint/imagen_large_checkpoint.pt', 'train.checkpoint_strict': False, 'train.checkpoint_model_only': False, 'train.non_blocking': True, 'train.use_ema': True, 'train.lr': 1.5e-05, 'train.eps': 1e-08, 'train.beta1': 0.9, 'train.beta2': 0.99, 'train.max_grad_norm': 'None', 'train.amp': True, 'train.group_wd_params': True, 'train.warmup_steps': 'None', 'train.cosine_decay_max_steps': 'None', 'train.cond_scale': 5, 'train.sample_texts': ['a 3d render of a purple cow, highly detailed', 'a sports car sketch'], 'model.text_encoder_name': 'google/t5-v1_1-xl', 'model.image_sizes': [64, 256], 'model.cond_drop_prob': 0.1, 'model.timesteps': 1000, 'model.unet1.dim': 256, 'model.unet1.cond_dim': 512, 'model.unet1.dim_mults': [1, 2, 3, 4], 'model.unet1.num_resnet_blocks': 3, 'model.unet1.layer_attns': [False, True, True, True], 'model.unet1.layer_cross_attns': [False, True, True, True], 'model.unet1.attn_heads': 8, 'model.unet1.ff_mult': 2, 'model.unet1.memory_efficient': False, 'model.unet1.dropout': 0.1, 'model.unet2.dim': 128, 'model.unet2.cond_dim': 512, 'model.unet2.dim_mults': [1, 2, 4, 8], 'model.unet2.num_resnet_blocks': [2, 4, 8, 8], 'model.unet2.layer_attns': [False, False, False, True], 'model.unet2.layer_cross_attns': [False, False, False, True], 'model.unet2.attn_heads': 8, 'model.unet2.ff_mult': 2, 'model.unet2.memory_efficient': True, 'model.unet2.dropout': 0.1}
2022-08-14 18:07:29,609 INFO    MainThread:30126 [wandb_init.py:init():548] starting backend
2022-08-14 18:07:29,609 INFO    MainThread:30126 [wandb_init.py:init():552] setting up manager
2022-08-14 18:07:29,615 INFO    MainThread:30126 [backend.py:_multiprocessing_setup():97] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2022-08-14 18:07:29,618 INFO    MainThread:30126 [wandb_init.py:init():558] backend started and connected
2022-08-14 18:07:29,625 INFO    MainThread:30126 [wandb_init.py:init():636] updated telemetry
2022-08-14 18:07:29,633 INFO    MainThread:30126 [wandb_init.py:init():667] communicating run to backend with 30 second timeout
2022-08-14 18:07:29,803 INFO    MainThread:30126 [wandb_run.py:_on_init():1982] communicating current version
2022-08-14 18:07:29,830 INFO    MainThread:30126 [wandb_run.py:_on_init():1986] got version response 
2022-08-14 18:07:29,830 INFO    MainThread:30126 [wandb_init.py:init():700] starting run threads in backend
2022-08-14 18:07:32,522 INFO    MainThread:30126 [wandb_run.py:_console_start():1962] atexit reg
2022-08-14 18:07:32,522 INFO    MainThread:30126 [wandb_run.py:_redirect():1820] redirect: SettingsConsole.WRAP_RAW
2022-08-14 18:07:32,523 INFO    MainThread:30126 [wandb_run.py:_redirect():1885] Wrapping output streams.
2022-08-14 18:07:32,523 INFO    MainThread:30126 [wandb_run.py:_redirect():1907] Redirects installed.
2022-08-14 18:07:32,523 INFO    MainThread:30126 [wandb_init.py:init():732] run started, returning control to user process
2022-08-14 18:07:36,640 WARNING MsgRouterThr:30126 [router.py:message_loop():76] message_loop has been closed
