2022-08-16 16:57:54,427 INFO    MainThread:17691 [wandb_setup.py:_flush():76] Configure stats pid to 17691
2022-08-16 16:57:54,427 INFO    MainThread:17691 [wandb_setup.py:_flush():76] Loading settings from /home/azureuser/.config/wandb/settings
2022-08-16 16:57:54,427 INFO    MainThread:17691 [wandb_setup.py:_flush():76] Loading settings from /home/azureuser/imagen/spaceforge/wandb/settings
2022-08-16 16:57:54,427 INFO    MainThread:17691 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'_require_service': 'True'}
2022-08-16 16:57:54,428 INFO    MainThread:17691 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'train.py', 'program': '/home/azureuser/imagen/spaceforge/train.py'}
2022-08-16 16:57:54,428 INFO    MainThread:17691 [wandb_init.py:_log_setup():461] Logging user logs to /home/azureuser/imagen/spaceforge/wandb/run-20220816_165754-1zjtddyd/logs/debug.log
2022-08-16 16:57:54,428 INFO    MainThread:17691 [wandb_init.py:_log_setup():462] Logging internal logs to /home/azureuser/imagen/spaceforge/wandb/run-20220816_165754-1zjtddyd/logs/debug-internal.log
2022-08-16 16:57:54,428 INFO    MainThread:17691 [wandb_init.py:init():495] calling init triggers
2022-08-16 16:57:54,428 INFO    MainThread:17691 [wandb_init.py:init():498] wandb.init called with sweep_config: {}
config: {'dataset.dataset_name': 'cc12m', 'dataset.dataset_path': '/datadrive4T/cc2m/cc12m/{00000..01242}.tar', 'dataset.image_size': 256, 'dataset.shuffle_size': 100000, 'dataset.shuffle_initial': 2500, 'dataset.shard_shuffle': True, 'dataset.num_images': 10428650, 'dataset.num_workers': 12, 'dataset.prefetch_factor': 1, 'dataset.pin_memory': True, 'dataset.drop_last': True, 'dataset.precomputed_embeddings': False, 'train.epochs': 8, 'train.batch_size': 256, 'train.unet_number': 1, 'train.unet1_max_batch_size': 128, 'train.unet2_max_batch_size': 32, 'train.load_checkpoint': False, 'train.load_checkpoint_path': '/datadrive4T/checkpoint/imagen_large_checkpoint.pt', 'train.checkpoint_rate': 1000, 'train.checkpoint_path': '/datadrive4T/checkpoint/imagen_large_checkpoint.pt', 'train.checkpoint_strict': True, 'train.checkpoint_model_only': False, 'train.image_non_blocking': True, 'train.embedding_non_blocking': False, 'train.cudnn_benchmark': True, 'train.use_ema': True, 'train.lr': 1.5e-05, 'train.eps': 1e-08, 'train.beta1': 0.9, 'train.beta2': 0.99, 'train.max_grad_norm': 'None', 'train.amp': True, 'train.group_wd_params': True, 'train.warmup_steps': 'None', 'train.cosine_decay_max_steps': 'None', 'train.cond_scale': 7.5, 'train.sample_texts': ['a 3d render of a purple cow, highly detailed', 'a sports car sketch'], 'model.text_encoder_name': 'google/t5-v1_1-xl', 'model.image_sizes': [64, 256, 1024], 'model.cond_drop_prob': 0.1, 'model.timesteps': 1000, 'model.unet1.dim': 512, 'model.unet1.cond_dim': 512, 'model.unet1.dim_mults': [1, 2, 3, 4], 'model.unet1.num_resnet_blocks': 3, 'model.unet1.layer_attns': [False, True, True, True], 'model.unet1.layer_cross_attns': [False, True, True, True], 'model.unet1.attn_heads': 8, 'model.unet1.ff_mult': 2, 'model.unet1.dropout': 0.1, 'model.unet1.memory_efficient': False, 'model.unet1.cosine_sim_attn': False, 'model.unet1.use_linear_attn': False, 'model.unet2.dim': 128, 'model.unet2.cond_dim': 512, 'model.unet2.dim_mults': [1, 2, 4, 8], 'model.unet2.num_resnet_blocks': [2, 4, 8, 8], 'model.unet2.layer_attns': [False, False, False, True], 'model.unet2.layer_cross_attns': [False, False, False, True], 'model.unet2.attn_heads': 8, 'model.unet2.ff_mult': 2, 'model.unet2.dropout': 0.1, 'model.unet2.memory_efficient': True, 'model.unet2.cosine_sim_attn': False, 'model.unet2.use_linear_attn': False, 'model.unet3.dim': 128, 'model.unet3.cond_dim': 512, 'model.unet3.dim_mults': [1, 2, 4, 8], 'model.unet3.num_resnet_blocks': [2, 4, 8, 8], 'model.unet3.layer_attns': [False, False, False, True], 'model.unet3.layer_cross_attns': [False, False, False, True], 'model.unet3.attn_heads': 8, 'model.unet3.ff_mult': 2, 'model.unet3.dropout': 0.1, 'model.unet3.memory_efficient': True, 'model.unet3.cosine_sim_attn': False, 'model.unet3.use_linear_attn': False}
2022-08-16 16:57:54,428 INFO    MainThread:17691 [wandb_init.py:init():548] starting backend
2022-08-16 16:57:54,428 INFO    MainThread:17691 [wandb_init.py:init():552] setting up manager
2022-08-16 16:57:54,431 INFO    MainThread:17691 [backend.py:_multiprocessing_setup():97] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2022-08-16 16:57:54,433 INFO    MainThread:17691 [wandb_init.py:init():558] backend started and connected
2022-08-16 16:57:54,441 INFO    MainThread:17691 [wandb_init.py:init():636] updated telemetry
2022-08-16 16:57:54,449 INFO    MainThread:17691 [wandb_init.py:init():667] communicating run to backend with 30 second timeout
2022-08-16 16:57:54,640 INFO    MainThread:17691 [wandb_run.py:_on_init():1982] communicating current version
2022-08-16 16:57:54,665 INFO    MainThread:17691 [wandb_run.py:_on_init():1986] got version response 
2022-08-16 16:57:54,666 INFO    MainThread:17691 [wandb_init.py:init():700] starting run threads in backend
2022-08-16 16:57:56,101 INFO    MainThread:17691 [wandb_run.py:_console_start():1962] atexit reg
2022-08-16 16:57:56,102 INFO    MainThread:17691 [wandb_run.py:_redirect():1820] redirect: SettingsConsole.WRAP_RAW
2022-08-16 16:57:56,102 INFO    MainThread:17691 [wandb_run.py:_redirect():1885] Wrapping output streams.
2022-08-16 16:57:56,102 INFO    MainThread:17691 [wandb_run.py:_redirect():1907] Redirects installed.
2022-08-16 16:57:56,102 INFO    MainThread:17691 [wandb_init.py:init():732] run started, returning control to user process
2022-08-16 16:58:23,088 WARNING MsgRouterThr:17691 [router.py:message_loop():76] message_loop has been closed
